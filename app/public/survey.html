<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <title>Survey</title>
</head>

<body>

    <div class="container indigo lighten-4 s12 m8">
        <form id="newProfileSurvey">
            <textarea name="name" id="profileName"></textarea>
            <textarea name="photo" id="photoURL"></textarea>

            <div class="input-field col s12">
                <select data-num='1'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Cookie (1) to Cake (10)</label>
            </div>
            <div class="input-field col s12">
                <select data-num='2'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Nature (1) to Space (10)</label>
            </div>


            <div class="input-field col s12"><select data-num='3'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Waves (1) to Clouds (10)</label> </div>
            <div class="input-field col s12"><select data-num='4'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Sweet (1) to Spicy (10)</label> </div>
            <div class="input-field col s12"><select data-num='5'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Violet (1) to Red (10)</label> </div>
            <div class="input-field col s12"><select data-num='6'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Swimming (1) to Art (10)</label> </div>
            <div class="input-field col s12"><select data-num='7'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Music (1) to Storytelling (10)</label> </div>
            <div class="input-field col s12"><select data-num='8'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Skipping (1) to Swaying (10)</label> </div>
            <div class="input-field col s12">
                <select data-num='9'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <label>Running (1) to Dancing (10)</label>
            </div>
            <div class="input-field col s12"><select data-num='10'>
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select><label>Aaaayyy!!! (1) to Geronimo!!!(10)</label> </div>
            <button class="waves-effect waves-light btn blue" type="submit">Find a Friend!</button>
        </form>
    </div>

    <div id="recommendedFriend" class="modal"> <div id="friendName"></div> <img id="friendImage" class="materialboxed" width="650" src="images/sample-1.jpg"></div>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script type="text/javascript">

        $("#newProfileSurvey").on("submit", function (event) {
            event.preventDefault();
            //Validate Entries
            let questionsAnswered = true;
            if ($('#profileName').val().trim() == "") { questionsAnswered = false; }
            if ($('#photoURL').val().trim() == "") { questionsAnswered = false; }
            $('select').each(function (index, element) { if (element.value == "") { questionsAnswered = false; } })

            if (questionsAnswered) {
                let newProfile = {
                    name: $('#profileName').val().trim(),
                    photo: $('#photoURL').val().trim(),
                    //Take all the selects.   Sort them by data-id (just in case).                             Use map to Convert them from DOM to just the selected value.
                    scores: $.map($('select').sort((a, b) => { return $(a).data('num') - $(b).data('num'); }), x => x.value)
                }
                $.post("/api/friends", newProfile, function(data) {
                    //Open the modal with the new friend data which should be found in friends.js
                    $('#friendName').html(`<h1>${data.name}</h1>`);
                    $('#friendImage').attr("src",data.photo);
                    M.Modal.getInstance($('#recommendedFriend')).open();
                });
            }
            else {
                M.toast({ html: 'Please Answer all the questions before submitting.' })
            }
        });

        $(document).ready(function () {
            $('.modal').modal();
            $('select').formSelect();
            $('.materialboxed').materialbox();
        });
    </script>
</body>

</html>