<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <title>Survey</title>
</head>
<body>

    <form id="newProfileSurvey">
        <textarea name="name" id="profileName"></textarea>
        <textarea name="photo" id="photoURL"></textarea>
        <select class="browser-default" data-num='1'>
                <option value="" disabled selected>Cookie (1) to Cake (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default"  data-num='2'>
                <option value="" disabled selected>Nature (1) to Space (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='3'>
                <option value="" disabled selected>Waves (1) to Clouds (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='4'>
                <option value="" disabled selected>Sweet (1) to Spicy (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='5'>
                <option value="" disabled selected>Violet (1) to Red (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='6'>
                <option value="" disabled selected>Swimming (1) to Art (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='7'>
                <option value="" disabled selected>Music (1) to Storytelling (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='8'>
                <option value="" disabled selected>Skipping (1) to Swaying (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='9'>
                <option value="" disabled selected>Running (1) to Dancing (10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <select class="browser-default" data-num='10'>
                <option value="" disabled selected>Aaaayyy!!! (1) to Geronimo!!!(10)</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
        <button type="submit">Find a Friend!</button>
    </form>



    <div id="recommendedFriend" class="modal"></div>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script type="text/javascript">

        $("#SubmitInfo").on("submit", function(event) {

            event.preventDefault();

            //Validate Entries
            let questionsAnswered = true;
            if ($('#profileName').val().trim() == "") { questionsAnswered = false; }
            if ($('#photoURL').val().trim() == "") { questionsAnswered = false; }
            $('select').each( function(index, element) { if(element.value == "") { questionsAnswered = false; } })


            if(questionsAnswered) {
                let newProfile = {
                    name: $('#profileName').val().trim(),
                    photo: $('#photoURL').val().trim(),
                    //Take all the selects.   Sort them by id (just in case).                                  Use map to Convert them from DOM to just the selected value.
                    scores: $.map($('select').sort( (a,b) => { return $(a).data('num') - $(b).data('num'); }), x => x.value)
                }
                $.ajax("/api/friends", {
                    type: "POST",
                    data: newProfile
                }
                );
            }
            else {
                //Indicate they need to answer all the questions before continuing.
            }
        }).then(function() {
            //Open the modal with the new friend data which should be found in friends.js

            //location.reload();
        });

        $(document).ready(function() {
            $('.modal').modal();
        });
    </script>
</body>
</html>